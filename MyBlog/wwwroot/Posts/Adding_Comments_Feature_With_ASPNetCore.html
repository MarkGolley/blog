<!-- PublishedDate: 2025-6-02 -->
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Adding A Comments Feature with ASP.NET Core</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../wwwroot/css/blogs.css">
</head>
<body>
<h1>Adding A Comments Feature with ASP.NET Core</h1>

<p>Since starting this blog I've had a few readers send me comments on my posts. There are many third-party comment solutions available which embed a widget (like a &lt;script&gt;) into your blog pages so there no backend setup required, you can use services like Disqus. I fancied building my own solution for greater learning opportunities. For now my solution is using a file system to store the comments, but i plan to extend that to utilising a database to further gain experience.</p>

<h2>Why Did I Build My Own Comments System?</h2>
<p>Building your own comment system rather than using a hosted solution like Disqus offers several advantages:</p>
<ul>
    <li><strong>Full control over data</strong>: I own and store all comment data</li>
    <li><strong>Customizable UI</strong>: I can style the comment section to match my blog</li>
    <li><strong>No third-party dependencies</strong>: Nothing external required</li>
    <li><strong>Learning opportunity</strong>: Growing my understanding of ASP.NET Core</li>
</ul>

<h2>High Level Implementation Guide</h2>
<p>Let's walk through how I implemented my solution.</p>

<h3>1. Create a Comment Model</h3>
<p>I defined what I wanted a comment to look like:</p>
<pre><code class="language-csharp">public class Comment
{
    public int Id { get; set; }
    public string Author { get; set; }
    public string Content { get; set; }
    public DateTime PostedAt { get; set; }
    public string PostId { get; set; }
}</code></pre>

<h3>2. Update my ViewModel for Blog Posts with Comments</h3>
<p>So my blog post view can display both the post content and its comments I updated my ViewModel to combine them:</p>
<pre><code class="language-csharp">public class BlogPostViewModel
{
    public BlogPost Post { get; set; }
    public List&lt;Comment&gt; Comments { get; set; }
}</code></pre>

<h3>3. Implementing my Comment Service</h3>
<p>My service handles the storaging and getting of comments:</p>
<pre><code class="language-csharp">public class CommentService
{
    private readonly string _basePath = "App_Data/comments";

    public List&lt;Comment&gt; GetComments(string postTitle)
    {
        // Retrieves comments for a post from JSON file or returns empty list if file doesn't exist
    }

    public void AddComment(Comment comment)
    {
        // Adds a new comment to the post's comment list with timestamp and ID, then saves all comments to JSON file
    }
}</code></pre>

<h3>4. Updated My Blog Controller</h3>
<p>Modified my controller to work with comments:</p>
<pre><code class="language-csharp">[Route("blog")]
public class BlogController : Controller
{
    private readonly BlogService _blogService;
    private readonly CommentService _commentService;

    public BlogController(BlogService blogService, CommentService commentService)
    {
        _blogService = blogService;
        _commentService = commentService;
    }

    [HttpGet("{slug}")]
    public IActionResult Post(string slug)
    {
        // Retrieves a blog post and its comments by slug, then displays them using the BlogPostViewModel
    }

    [HttpPost("comment")]
    public IActionResult PostComment(Comment comment)
    {
        // Handles comment submission by saving it to the comment service and redirecting back to the blog post
    }
}</code></pre>

<h3>5. Updated My Blog Post View</h3>
<p>Finally, I had to modify my Razor view to display and collect comments which was really just adding on top of the displaying of the blog post content to now include existing comments and a form for adding new comments.</p>

<h2>What's next?</h2>
<p>Now I have a very basic system working i'm thinking about making some improvements:</p>
<ol>
    <li><strong>Database storage</strong>: Moving from JSON files to a database</li>
    <li><strong>Anti-spam measures</strong>: Add CAPTCHA or honeypot fields (I hadn't heard of these before reading about them)</li>
    <li><strong>Comment moderation</strong>: Implement an approval system for comments</li>
    <li><strong>Notifications</strong>: Emailing me when new comments are posted</li>
</ol>

<h2>Where did I go wrong?</h2>
<p>If you try this yourself then watch out for these problems:</p>
<ul>
    <li><strong>Model type mismatches</strong>: Ensure your Razor view's <code>@model</code> matches what your controller returns as I changed the name</li>
    <li><strong>Port conflicts</strong>: When trying to run locally I was using port 80 and another service was already using it</li>
</ul>

<h2>Conclusion</h2>
<p>Building a comments system for my blog has been both fairly easy but a nice feature to add. I gained some more experience and I also now have control over how comments are/will be handled on my site.</p>

<p>This overview gives you some ideas to get started, third-party solutions are out there but you might learn less!</p>

<p>Let me know your comments below!</p>

</body>
</html>